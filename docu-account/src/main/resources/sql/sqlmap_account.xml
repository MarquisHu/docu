<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.docu.account.dao.AccountDao">
    
    <resultMap id="ACCOUNT_RESULT_MAP" type="Account">
        <result property="accountId" column="ACCOUNT_ID" />
		<result property="userId" column="USER_ID" />
		<result property="balanceAmount" column="BALANCE_AMOUNT" />
		<result property="privateAmount" column="PRIVATE_AMOUNT" />
		<result property="commonAmount" column="COMMON_AMOUNT" />
		<result property="updateBy" column="UPDATE_BY" />
		<result property="updateTime" column="UPDATE_TIME" />
	</resultMap>
	
	<sql id="ACCOUNT_DO_QUERY_COLUMNS">
	    A1.ACCOUNT_ID		accountId,
		A1.USER_ID 			userId, 
		A1.BALANCE_AMOUNT 	balanceAmount, 
		A1.PRIVATE_AMOUNT 	privateAmount, 
		A1.COMMON_AMOUNT 	commonAmount,
		A1.UPDATE_BY 		updateBy,
		date_format(A1.UPDATE_TIME, '%Y-%m-%d %h:%i:%s') updateTime
	</sql>

	<sql id="ACCOUNT_DO_QUERY_PARAMS">
		<where>
		    <if test="accountId != null &amp;&amp; accountId != 0">ACCOUNT_ID = #{accountId,jdbcType=BIGINT}</if>
			<if test="userId != null">AND USER_ID = #{userId,jdbcType=VARCHAR}</if>
			<if test="balanceAmount != null">AND BALANCE_AMOUNT = #{balanceAmount,jdbcType=FLOAT}</if>
			<if test="privateAmount != null">AND PRIVATE_AMOUNT = #{privateAmount,jdbcType=FLOAT}</if>
			<if test="commonAmount != null">AND COMMON_AMOUNT = #{commonAmount,jdbcType=FLOAT}</if>
			<if test="updateBy != null">AND UPDATE_BY = #{updateBy,jdbcType=VARCHAR}</if>
		</where>
	</sql>
	
    <insert id="insertAccount" parameterType="Account">
		INSERT INTO DOCU_ERP_ACCOUNT(
			ACCOUNT_ID,
			USER_ID, 
			BALANCE_AMOUNT, 
			PRIVATE_AMOUNT, 
			COMMON_AMOUNT,
			UPDATE_BY,
			UPDATE_TIME
		) VALUES (
			#{accountId,jdbcType=BIGINT},
		 	#{userId,jdbcType=VARCHAR},
		 	#{balanceAmount,jdbcType=FLOAT},
		 	#{privateAmount,jdbcType=FLOAT},
		 	#{commonAmount,jdbcType=FLOAT},
		 	#{updateBy,jdbcType=VARCHAR},
		 	#{updateTime,jdbcType=VARCHAR}
		)
	</insert>
	
    <update id="updateAccount" parameterType="Account">
	    <![CDATA[
			UPDATE DOCU_ERP_ACCOUNT
		]]>
		<set>
			<if test="balanceAmount != null">
			    <![CDATA[
			    	BALANCE_AMOUNT = #{balanceAmount,jdbcType=FLOAT},
				]]>
			</if>
			<if test="privateAmount != null">
			    <![CDATA[
			    	PRIVATE_AMOUNT = #{privateAmount,jdbcType=FLOAT},
				]]>
			</if>
			<if test="commonAmount != null">
			    <![CDATA[
			    	COMMON_AMOUNT = #{commonAmount,jdbcType=FLOAT},
				]]>
			</if>
			<if test="updateBy != null">
			    <![CDATA[
			    	UPDATE_BY = #{updateBy,jdbcType=VARCHAR},
				]]>
			</if>
			<if test="updateTime != null">
			    <![CDATA[
			    	UPDATE_TIME = #{updateTime,jdbcType=VARCHAR}
				]]>
			</if>
		</set>
		WHERE USER_ID = #{userId,jdbcType=VARCHAR}
	</update>
	
    <select id="findAccount" parameterType="String" resultMap="ACCOUNT_RESULT_MAP">
		SELECT
		<include refid="ACCOUNT_DO_QUERY_COLUMNS" />
	    <![CDATA[  
	     FROM DOCU_ERP_ACCOUNT A1 WHERE A1.USER_ID = #{userId,jdbcType=VARCHAR}
	    ]]>
	</select>
	
	<select id="findAccounts" parameterType="Account" resultMap="ACCOUNT_RESULT_MAP">
		SELECT
		<include refid="ACCOUNT_DO_QUERY_COLUMNS" />
		FROM DOCU_ERP_ACCOUNT A1
		<include refid="ACCOUNT_DO_QUERY_PARAMS" />
	</select>
	
	<select id="queryAccountTotal" parameterType="com.docu.components.common.QueryBase" resultType="int">
	    SELECT
		COUNT(*)
		<![CDATA[  
	     	FROM DOCU_ERP_ACCOUNT A1
	    ]]>
	    <where>
	        <if test="entity.accountId != null &amp;&amp; entity.accountId != 0">
			    <![CDATA[
			    	AND ACCOUNT_ID = #{entity.accountId,jdbcType=BIGINT}
				]]>
			</if>
			<if test="entity.userId != null">
			    <![CDATA[
			    	AND USER_ID = #{entity.userId,jdbcType=VARCHAR}
				]]>
			</if>
			<if test="entity.balanceAmount != null">
			    <![CDATA[
			    	AND BALANCE_AMOUNT = #{entity.balanceAmount,jdbcType=FLOAT}
				]]>
			</if>
			<if test="entity.privateAmount != null">
			    <![CDATA[
			    	AND PRIVATE_AMOUNT = #{entity.privateAmount,jdbcType=FLOAT}
				]]>
			</if>
			<if test="entity.commonAmount != null">
			    <![CDATA[
			    	AND COMMON_AMOUNT = #{entity.commonAmount,jdbcType=FLOAT}
				]]>
			</if>
			<if test="entity.updateBy != null">
			    <![CDATA[
			    	AND UPDATE_BY = #{entity.updateBy,jdbcType=VARCHAR}
				]]>
			</if>
		</where>
	</select>
	
	<select id="queryAccount" parameterType="com.docu.components.common.QueryBase" resultMap="ACCOUNT_RESULT_MAP">
	    SELECT
		<include refid="ACCOUNT_DO_QUERY_COLUMNS" />
		<![CDATA[  
	     	FROM DOCU_ERP_ACCOUNT A1
	    ]]>
	    <where>
	        <if test="entity.accountId != null &amp;&amp; entity.accountId != 0">
			    <![CDATA[
			    	AND ACCOUNT_ID = #{entity.accountId,jdbcType=BIGINT}
				]]>
			</if>
			<if test="entity.userId != null">
			    <![CDATA[
			    	AND USER_ID = #{entity.userId,jdbcType=VARCHAR}
				]]>
			</if>
			<if test="entity.balanceAmount != null">
			    <![CDATA[
			    	AND BALANCE_AMOUNT = #{entity.balanceAmount,jdbcType=FLOAT}
				]]>
			</if>
			<if test="entity.privateAmount != null">
			    <![CDATA[
			    	AND PRIVATE_AMOUNT = #{entity.privateAmount,jdbcType=FLOAT}
				]]>
			</if>
			<if test="entity.commonAmount != null">
			    <![CDATA[
			    	AND COMMON_AMOUNT = #{entity.commonAmount,jdbcType=FLOAT}
				]]>
			</if>
			<if test="entity.updateBy != null">
			    <![CDATA[
			    	AND UPDATE_BY = #{entity.updateBy,jdbcType=VARCHAR}
				]]>
			</if>
		</where>
		ORDER BY A1.ACCOUNT_ID, A1.USER_ID 
		LIMIT #{preEndNum}, #{pageSize}
	</select>
	
	<select id="getSequenceUuid" parameterType="String" resultType="long">
		SELECT NEXTVAL(#{sequenceName,jdbcType=VARCHAR}) AS NEXT_SEQUENCE;
	</select>
</mapper>